package com.CMPUT301F22T25.malwarepolymorphism.features.mealplans.UI;

import android.os.Bundle;

import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;
import androidx.recyclerview.widget.LinearLayoutManager;

import com.CMPUT301F22T25.malwarepolymorphism.databinding.ActivityMealPlanAddBinding;
import com.CMPUT301F22T25.malwarepolymorphism.databinding.ActivityViewMealPlanBinding;
import com.CMPUT301F22T25.malwarepolymorphism.features.mealplans.domain.data.MealPlanRepository;
import com.CMPUT301F22T25.malwarepolymorphism.features.mealplans.domain.entities.MealPlan;
import com.CMPUT301F22T25.malwarepolymorphism.features.mealplans.domain.entities.MealPlanRecipeMember;
import com.CMPUT301F22T25.malwarepolymorphism.features.recipes.domain.entities.RecipeIngredientMember;

import java.util.List;

import javax.inject.Inject;

import dagger.hilt.android.AndroidEntryPoint;

@AndroidEntryPoint
public class ViewMealPlanActivity extends AppCompatActivity {

    @Inject
    MealPlanRepository repository;

    MealPlan mealPlan;

    ActivityViewMealPlanBinding binding;

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        mealPlan = repository.getMealPlan(getIntent().getStringExtra("mealPlanId"));

        binding = ActivityViewMealPlanBinding.inflate(getLayoutInflater());

        binding.mealPlanTitle.setText(mealPlan.getTitle());

        String servings = "Servings";
        if (mealPlan.getNumberOfServings() == 1) {
            servings = "1 Serving";
        } else {
            servings = mealPlan.getNumberOfServings() + " Servings";
        }
        binding.numberOfServings.setText(servings);
        List<MealPlanRecipeMember> recipes = mealPlan.getRecipes();

        // set the recipes in recycler view
        MealPlanRecipeMemberRecyclerViewAdapter recipesAdapter = new MealPlanRecipeMemberRecyclerViewAdapter(recipes, position -> {});
        recipesAdapter.setRecipes(recipes);
        recipesAdapter.notifyDataSetChanged();
        binding.recipesList.setAdapter(recipesAdapter);
        binding.recipesList.setLayoutManager(new LinearLayoutManager(this, LinearLayoutManager.VERTICAL, false));

    }
}
