package com.CMPUT301F22T25.malwarepolymorphism.features.recipes.UI;

import android.annotation.SuppressLint;
import android.os.Bundle;
import android.util.Log;

import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;
import androidx.recyclerview.widget.LinearLayoutManager;

import com.CMPUT301F22T25.malwarepolymorphism.databinding.ActivityViewRecipeBinding;
import com.CMPUT301F22T25.malwarepolymorphism.features.recipes.domain.entities.Recipe;
import com.CMPUT301F22T25.malwarepolymorphism.features.recipes.domain.usecases.GetRecipeUseCase;
import com.bumptech.glide.Glide;

import javax.inject.Inject;

import dagger.hilt.android.AndroidEntryPoint;

@AndroidEntryPoint
public class ViewRecipeActivity extends AppCompatActivity {

    @Inject
    GetRecipeUseCase getRecipeUseCase;

    private ActivityViewRecipeBinding binding;
    @SuppressLint("SetTextI18n")
    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        binding = ActivityViewRecipeBinding.inflate(getLayoutInflater());
        setContentView(binding.getRoot());

        Recipe recipe = getRecipeUseCase.execute(getIntent().getStringExtra("recipeId"));

        Log.w("VIEW_IMAGE_URL", recipe.getImageUrl());
        Glide.with(this)
                .load(recipe.getImageUrl())
                .disallowHardwareConfig()
                .into(binding.recipeImage);

        binding.recipeTitle.setText(recipe.getTitle());
        binding.numberOfServings.setText(String.valueOf(recipe.getNumberOfServings()));
        binding.preparationTime.setText(recipe.getPreparationTimeInMinutes() + " minutes");

        binding.recipeIngredientsList.setAdapter(
                new EditRecipeMemberIngredientAdapter(recipe.getIngredients(), null));
        binding.recipeIngredientsList.setLayoutManager(new LinearLayoutManager(this,
                LinearLayoutManager.VERTICAL, false));

        binding.commentsTextField.setText(recipe.getComments());
    }
}
